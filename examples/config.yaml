# limen configuration example
# YAML rules that compliance teams can review without reading Python.

version: "1.0"
policy_version: "1.0.0"

rules:
  # Block dangerous SQL patterns
  - name: block_sql_injection
    type: regex_block
    applies_to: ["execute_sql", "run_query"]
    params:
      fields: ["query"]
      patterns:
        - "(?i)(DROP|DELETE|TRUNCATE)\\s+TABLE"
        - "(?i);\\s*--"
        - "(?i)UNION\\s+SELECT"

  # Require confirmation IDs on sensitive operations
  - name: require_confirmation
    type: regex_require
    applies_to: ["send_email", "transfer_funds"]
    params:
      fields: ["confirmation_id"]
      pattern: "^CONF-[A-Z0-9]{8}$"

  # Scan all tool outputs for PII
  - name: detect_pii
    type: pii_detect
    applies_to: ["*"]
    params:
      detectors:
        - email
        - phone_intl
        - hk_id
        - credit_card
      action: block

  # Role-based tool access
  - name: tool_entitlement
    type: entitlement
    applies_to: ["*"]
    params:
      roles:
        analyst: ["search", "get_data", "summarize"]
        admin: ["*"]
        operator: ["search", "get_data", "execute_sql"]
      default: block
